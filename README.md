ğŸ² Dice App on Kubernetes with Monitoring

This project demonstrates a simple Flask-based Dice App deployed into a local Kubernetes cluster (via minikube) together with Prometheus + Grafana monitoring.

The app exposes:

/health â†’ readiness/liveness probe

/dice â†’ returns a random dice roll (1â€“6)

/metrics â†’ Prometheus-compatible metrics (app_ready, dice_rolls_total)

Grafana dashboard and Prometheus alerts for the app are provisioned automatically.

ğŸ“‹ Prerequisites

Linux or macOS

Git

Internet connection (the script installs everything you need: Docker, minikube, kubectl, helm)

âš ï¸ On Windows use WSL2
 with Ubuntu.


ğŸš€ Quickstart

Clone this repo and run the deployment script:

git clone https://github.com/<your-username>/<your-repo>.git
cd <your-repo>
chmod +x app_deploy.sh
./app_deploy.sh


The script will:

Install Docker, kubectl, minikube, and helm (if missing).

Start a local Kubernetes cluster with minikube and enable ingress-nginx.

Build and load the Docker image into minikube.

Deploy the Dice App (Deployment, Service, Ingress, ServiceMonitor).

Install kube-prometheus-stack via Helm with custom values.

Apply Grafana dashboard and Prometheus alert rules for the Dice App.

Warm up the app by hitting /dice multiple times.

Port-forward and automatically open:

Grafana â†’ http://localhost:3000

Prometheus â†’ http://localhost:9090/targets


ğŸ” Manual Verification

Check that the app responds:

# via Ingress
curl -s http://localhost/health
curl -s http://localhost/dice

# via port-forward (alternative)
kubectl -n dice port-forward svc/dice-svc 8080:80 &
curl -s http://127.0.0.1:8080/health
curl -s http://127.0.0.1:8080/dice

Check Prometheus targets:

kubectl -n monitoring port-forward svc/monitoring-kube-prometheus-prometheus 9090:9090
open http://localhost:9090/targets

Check Grafana dashboards:

kubectl -n monitoring port-forward svc/monitoring-grafana 3000:80
open http://localhost:3000

Default credentials (unless overridden by secret):

user: admin
password: <generated by script>

ğŸ› ï¸ Useful Commands

Rebuild app image and restart deployment:

docker build -t dice-app:latest .
minikube image load dice-app:latest
kubectl -n dice rollout restart deploy/dice-app

Tear down the cluster:

minikube delete --all --purge
docker system prune -af --volumes

ğŸ“Š Metrics & Alerts

app_ready â†’ readiness gauge (1/0)

dice_rolls_total â†’ counter of dice rolls

Example PromQL queries:

app_ready
sum(rate(dice_rolls_total[1m]))

Grafana dashboard â€œğŸ² Dice App Statusâ€ is provisioned automatically.